document.addEventListener("contextmenu", function (event) {
    var onClickData = {
        menuItemId: null,
        editable: null,
        pageUrl: location.href
    };
    var currentElement = event.target;
    var selection = window.getSelection().toString();
    if (selection.length > 0)
        onClickData.selectionText = selection;
    while (currentElement != null) {
        if (currentElement.nodeType == Node.ELEMENT_NODE) {
            var nodeName = currentElement.nodeName.toLowerCase();
            var currentElementAnchor = currentElement;
            var currentElementMedia = currentElement;
            // Anchor
            if (!onClickData.linkUrl && (nodeName == 'a' || nodeName == 'area') && typeof currentElementAnchor.href === "string" && currentElementAnchor.href.length > 0) {
                onClickData.linkUrl = currentElementAnchor.href;
            }
            if (!onClickData.srcUrl && ["video", "audio"].indexOf(nodeName) != -1 && typeof currentElementMedia.currentSrc === "string" && currentElementMedia.currentSrc.length > 0) {
                onClickData.srcUrl = currentElementMedia.currentSrc;
            }
            if (!onClickData.srcUrl && ["video", "source", "audio", "img"].indexOf(nodeName) != -1 && typeof currentElementMedia.src === "string" && currentElementMedia.src.length > 0) {
                onClickData.srcUrl = currentElementMedia.src;
            }
        }
        currentElement = currentElement.parentNode;
    }
    safari.self.tab.setContextMenuEventUserInfo(event, onClickData);
}, false);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3NhZmFyaS1jb250ZXh0bWVudS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFRLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLFVBQVMsS0FBSztJQUN0RCxJQUFJLFdBQVcsR0FBb0M7UUFDNUMsVUFBVSxFQUFFLElBQUk7UUFDaEIsUUFBUSxFQUFFLElBQUk7UUFDcEIsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJO0tBQ3RCLENBQUM7SUFFRixJQUFJLGNBQWMsR0FBZSxLQUFLLENBQUMsTUFBTSxDQUFDO0lBQzlDLElBQUksU0FBUyxHQUFHLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUVqRCxFQUFFLENBQUEsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUN2QixXQUFXLENBQUMsYUFBYSxHQUFHLFNBQVMsQ0FBQztJQUV2QyxPQUFNLGNBQWMsSUFBSSxJQUFJLEVBQzVCLENBQUM7UUFDQSxFQUFFLENBQUEsQ0FBQyxjQUFjLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FDaEQsQ0FBQztZQUNBLElBQUksUUFBUSxHQUFHLGNBQWMsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDNUMsSUFBSSxvQkFBb0IsR0FBc0IsY0FBYyxDQUFDO1lBQzdELElBQUksbUJBQW1CLEdBQXFCLGNBQWMsQ0FBQztZQUVwRSxTQUFTO1lBQ1QsRUFBRSxDQUFBLENBQUMsQ0FBQyxXQUFXLENBQUMsT0FBTyxJQUFJLENBQUMsUUFBUSxJQUFJLEdBQUcsSUFBSSxRQUFRLElBQUksTUFBTSxDQUFDLElBQUksT0FBTyxvQkFBb0IsQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFJLG9CQUFvQixDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQzVKLENBQUM7Z0JBQ0EsV0FBVyxDQUFDLE9BQU8sR0FBRyxvQkFBb0IsQ0FBQyxJQUFJLENBQUM7WUFDakQsQ0FBQztZQUVELEVBQUUsQ0FBQSxDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBTyxtQkFBbUIsQ0FBQyxVQUFVLEtBQUssUUFBUSxJQUFJLG1CQUFtQixDQUFDLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDekssV0FBVyxDQUFDLE1BQU0sR0FBRyxtQkFBbUIsQ0FBQyxVQUFVLENBQUM7WUFDckQsQ0FBQztZQUVELEVBQUUsQ0FBQSxDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPLG1CQUFtQixDQUFDLEdBQUcsS0FBSyxRQUFRLElBQUksbUJBQW1CLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM1SyxXQUFXLENBQUMsTUFBTSxHQUFHLG1CQUFtQixDQUFDLEdBQUcsQ0FBQztZQUM5QyxDQUFDO1FBQ0YsQ0FBQztRQUNELGNBQWMsR0FBRyxjQUFjLENBQUMsVUFBVSxDQUFDO0lBQzVDLENBQUM7SUFFSyxNQUFNLENBQUMsSUFBSyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxLQUFLLEVBQUUsV0FBVyxDQUFDLENBQUM7QUFDeEUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDIiwiZmlsZSI6ImpzL3NhZmFyaS1jb250ZXh0bWVudS5qcyIsInNvdXJjZXNDb250ZW50IjpbImRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbihldmVudCkge1xuXHR2YXIgb25DbGlja0RhdGE6IGNocm9tZS5jb250ZXh0TWVudXMuT25DbGlja0RhdGEgPSB7XG4gICAgICAgIG1lbnVJdGVtSWQ6IG51bGwsXG4gICAgICAgIGVkaXRhYmxlOiBudWxsLFxuXHRcdHBhZ2VVcmw6IGxvY2F0aW9uLmhyZWZcblx0fTtcblx0XG5cdHZhciBjdXJyZW50RWxlbWVudDogTm9kZSA9IDxOb2RlPmV2ZW50LnRhcmdldDtcblx0dmFyIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcblx0aWYoc2VsZWN0aW9uLmxlbmd0aCA+IDApXG5cdFx0b25DbGlja0RhdGEuc2VsZWN0aW9uVGV4dCA9IHNlbGVjdGlvbjtcblx0XHRcdFxuXHR3aGlsZShjdXJyZW50RWxlbWVudCAhPSBudWxsKVxuXHR7XG5cdFx0aWYoY3VycmVudEVsZW1lbnQubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUpXG5cdFx0e1xuXHRcdFx0dmFyIG5vZGVOYW1lID0gY3VycmVudEVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50RWxlbWVudEFuY2hvciA9IDxIVE1MQW5jaG9yRWxlbWVudD5jdXJyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50RWxlbWVudE1lZGlhID0gPEhUTUxNZWRpYUVsZW1lbnQ+Y3VycmVudEVsZW1lbnQ7XG5cblx0XHRcdC8vIEFuY2hvclxuXHRcdFx0aWYoIW9uQ2xpY2tEYXRhLmxpbmtVcmwgJiYgKG5vZGVOYW1lID09ICdhJyB8fCBub2RlTmFtZSA9PSAnYXJlYScpICYmIHR5cGVvZiBjdXJyZW50RWxlbWVudEFuY2hvci5ocmVmID09PSBcInN0cmluZ1wiICYmIGN1cnJlbnRFbGVtZW50QW5jaG9yLmhyZWYubGVuZ3RoID4gMClcblx0XHRcdHtcblx0XHRcdFx0b25DbGlja0RhdGEubGlua1VybCA9IGN1cnJlbnRFbGVtZW50QW5jaG9yLmhyZWY7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmKCFvbkNsaWNrRGF0YS5zcmNVcmwgJiYgW1widmlkZW9cIiwgXCJhdWRpb1wiXS5pbmRleE9mKG5vZGVOYW1lKSAhPSAtMSAmJiB0eXBlb2YgY3VycmVudEVsZW1lbnRNZWRpYS5jdXJyZW50U3JjID09PSBcInN0cmluZ1wiICYmIGN1cnJlbnRFbGVtZW50TWVkaWEuY3VycmVudFNyYy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdG9uQ2xpY2tEYXRhLnNyY1VybCA9IGN1cnJlbnRFbGVtZW50TWVkaWEuY3VycmVudFNyYztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYoIW9uQ2xpY2tEYXRhLnNyY1VybCAmJiBbXCJ2aWRlb1wiLCBcInNvdXJjZVwiLCBcImF1ZGlvXCIsIFwiaW1nXCJdLmluZGV4T2Yobm9kZU5hbWUpICE9IC0xICYmIHR5cGVvZiBjdXJyZW50RWxlbWVudE1lZGlhLnNyYyA9PT0gXCJzdHJpbmdcIiAmJiBjdXJyZW50RWxlbWVudE1lZGlhLnNyYy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdG9uQ2xpY2tEYXRhLnNyY1VybCA9IGN1cnJlbnRFbGVtZW50TWVkaWEuc3JjO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudE5vZGU7XG5cdH1cblx0XG5cdCg8YW55PnNhZmFyaS5zZWxmKS50YWIuc2V0Q29udGV4dE1lbnVFdmVudFVzZXJJbmZvKGV2ZW50LCBvbkNsaWNrRGF0YSk7XG59LCBmYWxzZSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
